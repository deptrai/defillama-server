# DeFiLlama Self-hosted Supabase Configuration
# 100% FREE WebSocket solution with unlimited connections

############
# Secrets
# YOU MUST CHANGE THESE BEFORE GOING LIVE
############

POSTGRES_PASSWORD=your-super-secret-and-long-postgres-password
JWT_SECRET=your-super-secret-jwt-token-with-at-least-32-characters-long
ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0
SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImV4cCI6MTk4MzgxMjk5Nn0.EGIM96RAZx35lJzdJsyH-qQwv8Hdp7fsn3W0YpN81IU
LOGFLARE_API_KEY=your-super-secret-and-long-logflare-key

############
# Database
############

POSTGRES_HOST=db
POSTGRES_DB=postgres
POSTGRES_PORT=5432

############
# API Proxy
############

KONG_HTTP_PORT=8000
KONG_HTTPS_PORT=8443

############
# API External URL
# Used as a base URL for constructing URLs returned as API responses.
# If not set, defaults to the request's hostname.
############

API_EXTERNAL_URL=http://localhost:8000
SUPABASE_PUBLIC_URL=http://localhost:8000

############
# Auth
############

## General
SITE_URL=http://localhost:3000
ADDITIONAL_REDIRECT_URLS=
JWT_EXPIRY=3600
DISABLE_SIGNUP=false
ENABLE_EMAIL_SIGNUP=true
ENABLE_EMAIL_AUTOCONFIRM=false
ENABLE_PHONE_SIGNUP=true
ENABLE_PHONE_AUTOCONFIRM=true
ENABLE_ANONYMOUS_USERS=false

## Mailer Config
MAILER_URLPATHS_INVITE=/auth/v1/verify
MAILER_URLPATHS_CONFIRMATION=/auth/v1/verify
MAILER_URLPATHS_RECOVERY=/auth/v1/verify
MAILER_URLPATHS_EMAIL_CHANGE=/auth/v1/verify

## Email auth
ENABLE_EMAIL_SIGNUP=true
ENABLE_EMAIL_AUTOCONFIRM=false
SMTP_ADMIN_EMAIL=admin@example.com
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your.email@gmail.com
SMTP_PASS=your-email-password
SMTP_SENDER_NAME=DeFiLlama

############
# Studio
############

STUDIO_DEFAULT_ORGANIZATION=DeFiLlama
STUDIO_DEFAULT_PROJECT=OnChain Services

############
# Functions
############

FUNCTIONS_VERIFY_JWT=false

############
# Logs
############

LOGFLARE_LOGGER_BACKEND_API_KEY=your-api-key

############
# Image Proxy
############

IMGPROXY_ENABLE_WEBP_DETECTION=true

############
# Database
############

PGRST_DB_SCHEMAS=public,storage,graphql_public

############
# Pooler
############

POOLER_DEFAULT_POOL_SIZE=20
POOLER_MAX_CLIENT_CONN=100

############
# REALTIME
############

# Disable this if you don't want realtime enabled.
ENABLE_REALTIME=true
REALTIME_MAX_CONNECTIONS=50000
REALTIME_MAX_CHANNELS_PER_CLIENT=1000
REALTIME_MAX_JOINS_PER_SECOND=10000
REALTIME_MAX_EVENTS_PER_SECOND=100000

############
# STORAGE
############

STORAGE_FILE_SIZE_LIMIT=52428800
STORAGE_S3_ENABLED=false
STORAGE_S3_BUCKET=supabase-storage
STORAGE_S3_REGION=
STORAGE_S3_ACCESS_KEY_ID=
STORAGE_S3_SECRET_ACCESS_KEY=
STORAGE_S3_URL=

############
# Analytics
############

LOGFLARE_API_KEY=your-super-secret-and-long-logflare-key
LOGFLARE_URL=http://localhost:54321

############
# Secrets
# Generate your own secrets: https://supabase.com/docs/guides/hosting/docker#generate-api-keys
############

# Use openssl to generate a random 32 character string: openssl rand -base64 32
# JWT_SECRET=your-super-secret-jwt-token-with-at-least-32-characters-long

# Use openssl to generate a random 32 character string: openssl rand -base64 32
# POSTGRES_PASSWORD=your-super-secret-and-long-postgres-password

############
# Dashboard
############

DASHBOARD_USERNAME=supabase
DASHBOARD_PASSWORD=this_password_is_insecure_and_should_be_updated

############
# Docker
############

# Change this if you are running Docker Desktop on macOS.
# The default value is /var/run/docker.sock
DOCKER_SOCKET_LOCATION=/var/run/docker.sock

############
# DeFiLlama Specific Configuration
############

# WebSocket Configuration
DEFILLAMA_WEBSOCKET_PORT=8080
DEFILLAMA_WEBSOCKET_HOST=0.0.0.0
DEFILLAMA_MAX_CONNECTIONS=50000
DEFILLAMA_MAX_CHANNELS_PER_CONNECTION=1000
DEFILLAMA_MESSAGE_RATE_LIMIT=10000
DEFILLAMA_CONNECTION_TIMEOUT=300

# API Configuration
DEFILLAMA_API_BASE_URL=http://localhost:8000
DEFILLAMA_API_KEY_HEADER=x-api-key
DEFILLAMA_CORS_ORIGINS=http://localhost:3000,https://defillama.com

# Database Configuration
DEFILLAMA_DB_POOL_SIZE=50
DEFILLAMA_DB_MAX_CONNECTIONS=200
DEFILLAMA_DB_CONNECTION_TIMEOUT=30

# Cache Configuration
DEFILLAMA_REDIS_URL=redis://localhost:6379
DEFILLAMA_CACHE_TTL=300
DEFILLAMA_CACHE_MAX_KEYS=100000

# Monitoring Configuration
DEFILLAMA_METRICS_ENABLED=true
DEFILLAMA_METRICS_PORT=9090
DEFILLAMA_LOG_LEVEL=info

# Performance Tuning
DEFILLAMA_WORKER_PROCESSES=auto
DEFILLAMA_WORKER_CONNECTIONS=4096
DEFILLAMA_KEEPALIVE_TIMEOUT=65
DEFILLAMA_CLIENT_MAX_BODY_SIZE=10m

############
# Production Overrides
# Uncomment and modify for production deployment
############

# POSTGRES_PASSWORD=your-production-postgres-password
# JWT_SECRET=your-production-jwt-secret-with-at-least-32-characters
# SITE_URL=https://your-domain.com
# API_EXTERNAL_URL=https://api.your-domain.com
# SUPABASE_PUBLIC_URL=https://api.your-domain.com
# SMTP_HOST=your-smtp-server.com
# SMTP_USER=your-production-email@your-domain.com
# SMTP_PASS=your-production-email-password
# DASHBOARD_USERNAME=your-admin-username
# DASHBOARD_PASSWORD=your-secure-admin-password
