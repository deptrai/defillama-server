# DeFiLlama Server - Project Overview

*Generated by BMAD Method v6.0.0-alpha.0 on 2025-10-13*

## üèóÔ∏è Project Architecture

**DeFiLlama Server** is a comprehensive **monorepo** containing the backend infrastructure for the DeFiLlama ecosystem - the leading DeFi analytics platform. The project implements a **serverless microservices architecture** on AWS, providing real-time TVL (Total Value Locked) data, cryptocurrency prices, and DeFi protocol analytics.

### üìä Repository Structure

```
defillama-server/
‚îú‚îÄ‚îÄ defi/           # Main DeFi TVL & Protocol API Service
‚îú‚îÄ‚îÄ coins/          # Cryptocurrency Price API Service  
‚îú‚îÄ‚îÄ common/         # Shared Utilities & Chain Mappings
‚îú‚îÄ‚îÄ docs/           # Project Documentation (this folder)
‚îî‚îÄ‚îÄ bmad/           # BMAD Method Framework Installation
```

## üéØ Core Services

### 1. DeFi Service (`defi/`)
**Purpose**: Main DeFi analytics API providing TVL data, protocol information, and DeFi ecosystem insights

**Key Features**:
- Protocol TVL tracking across 100+ blockchains
- Historical DeFi data and trends
- Protocol categorization and metadata
- Governance data integration
- Emissions and yield farming analytics

**Technology Stack**:
- **Runtime**: Node.js 20.x + TypeScript 5.0
- **Framework**: Serverless Framework v3.0
- **Database**: PostgreSQL + DynamoDB
- **Cloud**: AWS Lambda + S3 + CloudFront
- **Key Libraries**: ethers.js, @defillama/sdk, hyper-express

### 2. Coins Service (`coins/`)
**Purpose**: Cryptocurrency price API providing real-time and historical price data

**Key Features**:
- Multi-chain token price aggregation
- Historical price data storage
- Bridge token price reconciliation
- CoinGecko integration
- Real-time price updates

**Technology Stack**:
- **Runtime**: Node.js 16.x + TypeScript 5.0
- **Framework**: Serverless Framework v2.31
- **Database**: PostgreSQL + Redis + DynamoDB
- **Messaging**: Kafka (KafkaJS)
- **Cloud**: AWS Lambda + S3
- **Key Libraries**: ethers.js, @solana/web3.js, graphql

### 3. Common Library (`common/`)
**Purpose**: Shared utilities and configuration data

**Key Features**:
- Chain ID to CoinGecko ID mappings
- Shared type definitions
- Common utility functions

## üåê External Integrations

### Adapter Ecosystems
- **DefiLlama-Adapters**: Protocol-specific TVL calculation adapters
- **Dimension-Adapters**: Fee, volume, and user analytics adapters  
- **Emissions-Adapters**: Token emission and reward tracking adapters

### Data Sources
- **Blockchain RPCs**: Direct blockchain data access
- **CoinGecko API**: Price data aggregation
- **Protocol APIs**: Direct protocol integrations
- **Subgraphs**: The Graph protocol data

## üöÄ Deployment Architecture

### AWS Infrastructure
- **Compute**: AWS Lambda functions (serverless)
- **Storage**: DynamoDB (NoSQL) + PostgreSQL (relational) + S3 (object)
- **Caching**: Redis (coins service)
- **CDN**: CloudFront distribution
- **Monitoring**: AWS X-Ray tracing

### Deployment Regions
- **Primary**: eu-central-1 (Europe)
- **Environment**: Production (`prod`) and Development (`dev`)

## üìà Scale & Performance

### Data Volume
- **Protocols Tracked**: 3000+ DeFi protocols
- **Blockchains Supported**: 100+ blockchain networks
- **Historical Data**: Multi-year TVL and price history
- **Update Frequency**: Real-time to hourly depending on data type

### API Performance
- **Response Time**: <200ms for cached data
- **Availability**: 99.9% uptime SLA
- **Rate Limiting**: Implemented per service
- **Caching Strategy**: Multi-layer (CloudFront + Redis + DynamoDB)

## üîó Public APIs

### DeFi API
- **Base URL**: `https://api.llama.fi`
- **Documentation**: https://defillama.com/docs/api
- **Key Endpoints**:
  - `/protocols` - List all protocols
  - `/tvl/{protocol}` - Protocol TVL data
  - `/charts` - Historical TVL charts
  - `/yields` - Yield farming data

### Coins API  
- **Base URL**: `https://coins.llama.fi`
- **Documentation**: https://docs.llama.fi/coin-prices-api
- **Key Endpoints**:
  - `/prices/current` - Current token prices
  - `/prices/historical` - Historical price data
  - `/coins` - Token metadata

## üõ†Ô∏è Development

### Prerequisites
- Node.js 16+ (18+ recommended)
- AWS CLI configured
- PostgreSQL (for local development)
- Redis (for coins service)

### Quick Start
```bash
# Clone repository
git clone https://github.com/DefiLlama/defillama-server.git
cd defillama-server

# Setup DeFi service
cd defi
npm install
npm run serve

# Setup Coins service  
cd ../coins
npm install
npm run serve
```

### Environment Variables
```bash
# Required for both services
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key
AWS_REGION=eu-central-1

# Service-specific
tableName=prod-table          # DeFi service
tableName=prod-coins-table    # Coins service
```

## üìö Documentation Links

- **API Documentation**: https://defillama.com/docs/api
- **Coin Prices API**: https://docs.llama.fi/coin-prices-api
- **Contributing Guide**: See individual service READMEs
- **Architecture Details**: [architecture.md](./architecture.md)
- **Development Guide**: [development-guide.md](./development-guide.md)

## üè∑Ô∏è Project Metadata

- **Project Type**: Backend API Services (Monorepo)
- **Architecture Style**: Serverless Microservices
- **Primary Language**: TypeScript
- **Cloud Provider**: AWS
- **License**: Open Source
- **Maintainer**: DeFiLlama Team

---

*This documentation was generated using BMAD Method v6.0.0-alpha.0 brownfield analysis workflow.*
