<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compliance Monitoring Test UI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        h1 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 14px;
        }

        .card {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .result {
            margin-top: 20px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }

        .result pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 13px;
            line-height: 1.6;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 8px;
        }

        .badge-clear {
            background: #4caf50;
            color: white;
        }

        .badge-flagged {
            background: #f44336;
            color: white;
        }

        .badge-review {
            background: #ff9800;
            color: white;
        }

        .badge-low {
            background: #4caf50;
            color: white;
        }

        .badge-medium {
            background: #ff9800;
            color: white;
        }

        .badge-high {
            background: #ff5722;
            color: white;
        }

        .badge-critical {
            background: #f44336;
            color: white;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîí Compliance Monitoring Test UI</h1>
            <p class="subtitle">Story 3.2.3 - Compliance Monitoring | Test Interface for API Endpoints</p>
        </div>

        <div class="card">
            <h2>Screen Wallet Address</h2>
            <div class="form-group">
                <label for="walletAddress">Wallet Address</label>
                <input type="text" id="walletAddress" placeholder="0x1234567890123456789012345678901234567890" value="0x1234567890123456789012345678901234567890">
            </div>
            <div class="form-group">
                <label for="chainId">Chain ID</label>
                <select id="chainId">
                    <option value="ethereum">Ethereum</option>
                    <option value="bsc">BSC</option>
                    <option value="polygon">Polygon</option>
                    <option value="arbitrum">Arbitrum</option>
                </select>
            </div>
            <button onclick="screenWallet()">üîç Screen Wallet</button>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Screening wallet...</p>
            </div>

            <div id="result" class="result" style="display: none;"></div>
        </div>

        <div class="card">
            <h2>Test Addresses</h2>
            <p style="margin-bottom: 15px; color: #666;">Click to test different scenarios:</p>
            <button onclick="testAddress('0x1111111111111111111111111111111111111111')" style="margin-right: 10px; margin-bottom: 10px;">‚úÖ Clear (Low Risk)</button>
            <button onclick="testAddress('0x1234567890123456789012345678901234567890')" style="margin-right: 10px; margin-bottom: 10px;">üö´ Flagged (Sanctions)</button>
            <button onclick="testAddress('0x5678901234567890123456789012345678901234')" style="margin-right: 10px; margin-bottom: 10px;">‚ö†Ô∏è Review (PEP)</button>
            <button onclick="testAddress('0x7890123456789012345678901234567890123456')" style="margin-right: 10px; margin-bottom: 10px;">‚ö†Ô∏è Review (Adverse Media)</button>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:3005';

        async function screenWallet() {
            const walletAddress = document.getElementById('walletAddress').value;
            const chainId = document.getElementById('chainId').value;
            const loading = document.getElementById('loading');
            const result = document.getElementById('result');

            if (!walletAddress) {
                alert('Please enter a wallet address');
                return;
            }

            loading.classList.add('active');
            result.style.display = 'none';

            try {
                const response = await fetch(`${API_BASE_URL}/v1/risk/compliance/screen`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        wallet_address: walletAddress,
                        chain_id: chainId,
                    }),
                });

                const data = await response.json();

                loading.classList.remove('active');
                result.style.display = 'block';

                if (data.success) {
                    displayResult(data.data);
                } else {
                    result.innerHTML = `<pre style="color: red;">Error: ${data.error}</pre>`;
                }
            } catch (error) {
                loading.classList.remove('active');
                result.style.display = 'block';
                result.innerHTML = `<pre style="color: red;">Error: ${error.message}</pre>`;
            }
        }

        function testAddress(address) {
            document.getElementById('walletAddress').value = address;
            screenWallet();
        }

        function displayResult(data) {
            const result = document.getElementById('result');
            
            const screeningBadge = getScreeningBadge(data.screeningResult);
            const riskBadge = getRiskBadge(data.riskLevel);

            result.innerHTML = `
                <h3>Screening Result</h3>
                <div style="margin: 15px 0;">
                    ${screeningBadge}
                    ${riskBadge}
                    <span class="badge" style="background: #2196f3; color: white;">Risk Score: ${data.riskScore.toFixed(2)}</span>
                </div>

                <h4 style="margin-top: 20px;">Details</h4>
                <table style="width: 100%; margin-top: 10px; border-collapse: collapse;">
                    <tr style="border-bottom: 1px solid #ddd;">
                        <td style="padding: 8px; font-weight: 600;">Wallet Address:</td>
                        <td style="padding: 8px; font-family: monospace;">${data.walletAddress}</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #ddd;">
                        <td style="padding: 8px; font-weight: 600;">Sanctions Match:</td>
                        <td style="padding: 8px;">${data.sanctions.match ? 'üö´ Yes (' + data.sanctions.list + ')' : '‚úÖ No'}</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #ddd;">
                        <td style="padding: 8px; font-weight: 600;">AML Risk Score:</td>
                        <td style="padding: 8px;">${data.aml.riskScore.toFixed(2)}</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #ddd;">
                        <td style="padding: 8px; font-weight: 600;">KYC Status:</td>
                        <td style="padding: 8px;">${data.kyc.status} ${data.kyc.level ? '(' + data.kyc.level + ')' : ''}</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #ddd;">
                        <td style="padding: 8px; font-weight: 600;">PEP Match:</td>
                        <td style="padding: 8px;">${data.pep.match ? '‚ö†Ô∏è Yes (' + data.pep.category + ')' : '‚úÖ No'}</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #ddd;">
                        <td style="padding: 8px; font-weight: 600;">Adverse Media:</td>
                        <td style="padding: 8px;">${data.adverseMedia.match ? '‚ö†Ô∏è Yes (' + data.adverseMedia.count + ' mentions, ' + data.adverseMedia.severity + ' severity)' : '‚úÖ No'}</td>
                    </tr>
                </table>

                <details style="margin-top: 20px;">
                    <summary style="cursor: pointer; font-weight: 600; padding: 10px; background: #f0f0f0; border-radius: 4px;">View Full JSON Response</summary>
                    <pre style="margin-top: 10px; padding: 15px; background: #f9f9f9; border-radius: 4px; overflow-x: auto;">${JSON.stringify(data, null, 2)}</pre>
                </details>
            `;
        }

        function getScreeningBadge(result) {
            const badges = {
                'clear': '<span class="badge badge-clear">‚úÖ CLEAR</span>',
                'flagged': '<span class="badge badge-flagged">üö´ FLAGGED</span>',
                'review_required': '<span class="badge badge-review">‚ö†Ô∏è REVIEW REQUIRED</span>',
            };
            return badges[result] || result;
        }

        function getRiskBadge(level) {
            const badges = {
                'low': '<span class="badge badge-low">LOW RISK</span>',
                'medium': '<span class="badge badge-medium">MEDIUM RISK</span>',
                'high': '<span class="badge badge-high">HIGH RISK</span>',
                'critical': '<span class="badge badge-critical">CRITICAL RISK</span>',
            };
            return badges[level] || level;
        }
    </script>
</body>
</html>

